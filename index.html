<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Familienquizz</title>
<style>
body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f2f2f2; }
#app { max-width: 800px; margin: auto; padding: 20px; }
.hidden { display: none; }
.grid { display: grid; gap: 3px; width: 100%; max-width: 600px; margin: 20px auto; }
.tile { width: 100%; padding-top: 100%; background: #444; background-size: cover; transition: opacity 0.4s ease-in-out; opacity: 0; }
button { padding: 12px 24px; margin: 5px; font-size: 16px; cursor: pointer; }
table { width: 100%; border-collapse: collapse; margin-top: 10px; }
th, td { border: 1px solid #333; padding: 5px; text-align: center; }
th { background: #ddd; }

/* Media Queries für kleine Displays */
@media (max-width: 480px) {
  .grid { grid-template-columns: repeat(3, 1fr); }
  button { font-size: 18px; padding: 14px 28px; }
}
@media (min-width: 481px) {
  .grid { grid-template-columns: repeat(6, 1fr); }
}
</style>
</head>
<body>
<div id="app">
<h1>Familienquizz</h1>

<div id="startScreen">
<p>Bitte Namen eingeben:</p>
<input id="playerName" type="text" style="padding:10px; font-size:16px;" />
<button onclick="startGame()">Start</button>
</div>

<div id="questionScreen" class="hidden">
<h2 id="questionText"></h2>
<div id="imageArea"></div>
<div id="answers"></div>
</div>

<div id="resultScreen" class="hidden">
<h2>Auswertung</h2>
<p id="score"></p>
<p id="time"></p>
<h3>Leaderboard</h3>
<div id="leaderboard"></div>
</div>
</div>

<script>
// --- QUESTIONS ---
const questions = [
{ q: "Wie heißt dieses Spiel?", img: "Spiel.jpg", answers: ["Malefiz","Mensch ärgere dich nicht","Rummikub","Megalon"], correct: 0 },
{ q: "In welcher Jahreszeit ist dieses Bild entstanden?", img: "Weinberg.jpg", answers: ["Frühling","Sommer","Herbst","Winter"], correct: 0 },
{ q: "Was wird hier gespielt?", img: "Ei.jpg", answers: ["Sackhüpfen","Eierlauf","Wikinger Schach","Boules"], correct: 1 },
{ q: "Wie viele Hunde sehen wir hier?", img: "Hund.jpg", answers: ["nur Ziegen","5","2","3"], correct: 3 },
{ q: "In welcher Stadt befinden wir uns hier?", img: "Stadt.jpg", answers: ["Tübingen","Göttingen","Düsseldorf","Heidelberg"], correct: 3 },
{ q: "Was wird hier gefeiert?", img: "Abschluss.jpg", answers: ["Berufsausbildung","Geburtstag","Schulabschluss","Tanzschulball"], correct: 2 },
{ q: "An welchem Tag ist dieses Bild entstanden?", img: "Freitag.jpg", answers: ["Samstag","Freitag","Sonntag","Dienstag"], correct: 1 },
{ q: "Wie heißt dieser Herr?", img: "Papst.jpg", answers: ["Franziskus","Johannes","Linus","Leo"], correct: 3 },
{ q: "In welchem Land wurde dieses Bild aufgenommen?", img: "Land.jpg", answers: ["Portugal","Türkei","Spanien","Frankreich"], correct: 2 },
{ q: "Welchen Vogel sehen wir hier?", img: "Vogel.jpg", answers: ["Turmfalke","Wanderfalke","Habicht","Bussard"], correct: 1 },
{ q: "Welche Sprache wird hier gesprochen?", img: "CostaRica.jpg", answers: ["Spanisch","Portugiesisch","Englisch","Französisch"], correct: 0 },
{ q: "Wie viele Menschen sehen wir hier?", img: "Family.jpg", answers: ["21","19","22","23"], correct: 2 }
];

let current = 0;
let correctCount = 0;
let startTime;
let player;

function startGame() {
  player = document.getElementById("playerName").value.trim();
  if (!player) return alert("Bitte Namen eingeben");
  document.getElementById("startScreen").classList.add("hidden");
  startTime = Date.now();
  loadQuestion();
}

function loadQuestion() {
  document.getElementById("questionScreen").classList.remove("hidden");
  const q = questions[current];
  document.getElementById("questionText").textContent = q.q;

  const area = document.getElementById("imageArea");
  area.innerHTML = "";

  // --- PUZZLE GRID ---
  const grid = document.createElement("div");
  grid.className = "grid";
  area.appendChild(grid);

  const tiles = [];
  let gridSize = window.innerWidth <= 480 ? 3 : 6;

  for (let row=0; row<gridSize; row++){
    for (let col=0; col<gridSize; col++){
      const t = document.createElement("div");
      t.className = "tile";
      t.style.backgroundImage = `url(${q.img})`;
      t.style.backgroundPosition = `${(col/(gridSize-1))*100}% ${(row/(gridSize-1))*100}%`;
      tiles.push(t);
      grid.appendChild(t);
    }
  }

  // --- WAIT 2 SEC BEFORE REVEAL ---
  setTimeout(() => {
    let remainingTiles = [...tiles];
    const revealSpeed = 400; // ms zwischen Kacheln
    const revealInterval = setInterval(() => {
      if (remainingTiles.length === 0) { clearInterval(revealInterval); return; }
      const r = Math.floor(Math.random() * remainingTiles.length);
      const tile = remainingTiles.splice(r,1)[0];
      tile.style.opacity = 1;
    }, revealSpeed);
  }, 2000);

  // --- ANSWERS ---
  const ans = document.getElementById("answers");
  ans.innerHTML = "";
  q.answers.forEach((a,i)=>{
    const b=document.createElement("button");
    b.textContent=a;
    b.onclick=()=>answer(i);
    ans.appendChild(b);
  });
}

function answer(i){
  if(i===questions[current].correct) correctCount++;
  current++;
  setTimeout(()=>{
    if(current>=questions.length) finish();
    else loadQuestion();
  },500);
}

function finish(){
  document.getElementById("questionScreen").classList.add("hidden");
  document.getElementById("resultScreen").classList.remove("hidden");

  const time = Math.round((Date.now()-startTime)/1000);
  document.getElementById("score").textContent = `Richtige Antworten: ${correctCount}`;
  document.getElementById("time").textContent = `Zeit: ${time} Sekunden`;

  let leaderboard = JSON.parse(localStorage.getItem("leaderboard")) || [];
  leaderboard.push({ name: player, score: correctCount, time: time });
  leaderboard.sort((a,b)=>b.score-a.score || a.time-b.time);
  localStorage.setItem("leaderboard", JSON.stringify(leaderboard));

  const lbDiv = document.getElementById("leaderboard");
  lbDiv.innerHTML="";

  const table = document.createElement("table");
  const header = document.createElement("tr");
  ["Rang","Spieler","Punkte","Zeit (s)"].forEach(h=>{
    const th=document.createElement("th");
    th.textContent=h;
    header.appendChild(th);
  });
  table.appendChild(header);

  leaderboard.forEach((entry,index)=>{
    const tr=document.createElement("tr");
    [index+1,entry.name,entry.score,entry.time].forEach(text=>{
      const td=document.createElement("td");
      td.textContent=text;
      tr.appendChild(td);
    });
    table.appendChild(tr);
  });

  lbDiv.appendChild(table);
}
</script>
</body>
</html>

